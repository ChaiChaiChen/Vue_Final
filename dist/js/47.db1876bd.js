"use strict";(self["webpackChunkvue_final"]=self["webpackChunkvue_final"]||[]).push([[47],{8464:function(e,t,l){l.d(t,{Z:function(){return A}});var a=l(3396),i=l(9242),s=l(7139);const c={"aria-label":"Page navigation example"},o={class:"pagination justify-content-center"},r={key:0,class:"page-item"},n=(0,a._)("span",{"aria-hidden":"true"},"«",-1),d=[n],p=["onClick"],u={key:1,class:"page-item"},h=(0,a._)("span",{"aria-hidden":"true"},"»",-1),m=[h];function _(e,t,l,n,h,_){return(0,a.wg)(),(0,a.iD)("nav",c,[(0,a._)("ul",o,[1!==l.pages.current_page?((0,a.wg)(),(0,a.iD)("li",r,[(0,a._)("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=(0,i.iM)((e=>_.updatePage(l.pages.current_page-1)),["prevent"])),"aria-label":"Previous"},d)])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,s.C_)(["page-item",{active:e===l.pages.current_page}]),key:e},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,i.iM)((t=>_.updatePage(e)),["prevent"])},(0,s.zw)(e),9,p)],2)))),128)),l.pages.current_page!==l.pages.total_pages?((0,a.wg)(),(0,a.iD)("li",u,[(0,a._)("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=(0,i.iM)((e=>_.updatePage(l.pages.current_page+1)),["prevent"])),"aria-label":"Next"},m)])):(0,a.kq)("",!0)])])}var g={props:["pages"],methods:{updatePage(e){console.log(e),this.$emit("emit-pages",e)}}},b=l(89);const f=(0,b.Z)(g,[["render",_]]);var A=f},4047:function(e,t,l){l.r(t),l.d(t,{default:function(){return ae}});var a=l(3396),i=l(7139);const s={class:"container"},c={class:"row mt-5"},o={class:"text-end mt-5"},r={class:"table mt-4 text-center table-radius"},n=(0,a._)("thead",{class:"table-theme"},[(0,a._)("tr",null,[(0,a._)("th",null,"標題"),(0,a._)("th",null,"文章內容"),(0,a._)("th",null,"日期"),(0,a._)("th",{width:"120"},"是否啟用"),(0,a._)("th",null,"編輯")])],-1),d={class:"text-truncate articles-description"},p={key:0,class:"is-enabled-border is-enabled"},u={key:1,class:"is-enabled-border not-enabled"},h=["onClick"],m=(0,a._)("i",{class:"bi bi-pencil-square"},null,-1),_=[m],g=["onClick"],b=(0,a._)("i",{class:"bi bi-trash3"},null,-1),f=[b];function A(e,t,l,m,b,A){const v=(0,a.up)("Pagination"),w=(0,a.up)("ArticleModal"),y=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("div",c,[(0,a._)("div",o,[(0,a._)("button",{class:"new-product",onClick:t[0]||(t[0]=e=>A.openArticleModal(!0))}," 新增留言 ")]),(0,a._)("table",r,[n,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(b.articles,((t,l)=>((0,a.wg)(),(0,a.iD)("tr",{key:l},[(0,a._)("td",null,(0,i.zw)(t.title),1),(0,a._)("td",d,(0,i.zw)(t.description),1),(0,a._)("td",null,(0,i.zw)(e.$filters.date(t.create_at)),1),(0,a._)("td",null,[!0===t.isPublic?((0,a.wg)(),(0,a.iD)("span",p,"啟用")):((0,a.wg)(),(0,a.iD)("span",u,"未啟用"))]),(0,a._)("td",null,[(0,a._)("button",{class:"btn btn-primary",onClick:e=>A.openArticleModal(!1,t)},_,8,h),(0,a._)("button",{class:"btn btn-danger",onClick:e=>A.openDelArticleModal(t)},f,8,g)])])))),128))])])])]),(0,a.Wm)(v,{pages:b.pagination,onEmitPages:A.getArticles},null,8,["pages","onEmitPages"]),(0,a.Wm)(w,{ref:"articleModal",article:b.tempArticle,onUpdateArticle:A.updateArticle},null,8,["article","onUpdateArticle"]),(0,a.Wm)(y,{item:b.tempArticle,ref:"delModal",onDelItem:A.delArticle},null,8,["item","onDelItem"])],64)}var v=l(9242);const w={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},y={class:"modal-dialog modal-xl",role:"document"},k={class:"modal-content border-0"},M=(0,a._)("div",{class:"modal-header bg-modal-brown text-white"},[(0,a._)("h5",{class:"modal-title"},[(0,a._)("span",null,"新增文章")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},D={class:"row"},$={class:"col-sm-4"},P={class:"mb-3"},C=(0,a._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),U={class:"mb-3"},Z=(0,a._)("label",{for:"customFile",class:"form-label"},[(0,a.Uk)("或 上傳圖片 "),(0,a._)("i",{class:"fas fa-spinner fa-spin"})],-1),F=["src"],V={class:"col-sm-8"},I={class:"mb-3"},N=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),S={class:"mb-3"},z=(0,a._)("label",{for:"title",class:"form-label"},"作者",-1),q={class:"mb-3"},H=(0,a._)("label",{for:"description",class:"form-label"},"描述",-1),W={class:"mb-3"},Y=(0,a._)("label",{for:"create_at"},"新增日期",-1),j={class:"mb-3"},E={class:"form-check"},K=(0,a._)("label",{class:"form-check-label",for:"isPublic"}," 是否啟用 ",-1),O={class:"modal-footer"},T=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function L(e,t,l,i,s,c){return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",y,[(0,a._)("div",k,[M,(0,a._)("div",x,[(0,a._)("div",D,[(0,a._)("div",$,[(0,a._)("div",P,[C,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempArticle.imageUrl=e),placeholder:"請輸入圖片連結"},null,512),[[v.nr,s.tempArticle.imageUrl]])]),(0,a._)("div",U,[Z,(0,a._)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:t[1]||(t[1]=(...e)=>c.uploadFile&&c.uploadFile(...e))},null,544)]),(0,a._)("img",{class:"img-fluid",src:s.tempArticle.imageUrl,alt:""},null,8,F)]),(0,a._)("div",V,[(0,a._)("div",I,[N,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[2]||(t[2]=e=>s.tempArticle.title=e),placeholder:"請輸入標題"},null,512),[[v.nr,s.tempArticle.title]])]),(0,a._)("div",S,[z,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempArticle.author=e),placeholder:"請輸入作者"},null,512),[[v.nr,s.tempArticle.author]])]),(0,a._)("div",q,[H,(0,a.wy)((0,a._)("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempArticle.description=e),placeholder:"請輸入描述",rows:"4"},null,512),[[v.nr,s.tempArticle.description]])]),(0,a._)("div",W,[Y,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"create_at","onUpdate:modelValue":t[5]||(t[5]=e=>s.create_at=e)},null,512),[[v.nr,s.create_at]])]),(0,a._)("div",j,[(0,a._)("div",E,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.tempArticle.isPublic=e),"true-value":!0,"false-value":!1,id:"isPublic"},null,512),[[v.e8,s.tempArticle.isPublic]]),K])])])])]),(0,a._)("div",O,[T,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=t=>e.$emit("update-article",s.tempArticle))},"確認 ")])])])],512)}var B=l(1339),G={props:{article:{type:Object,default(){return{}}}},emits:["update-article"],watch:{article(){this.tempArticle=this.article,console.log(this.article);const e=new Date(1e3*this.tempArticle.create_at).toISOString().split("T");[this.create_at]=e,this.tempArticle.content=" ","undefined"===typeof this.tempArticle.isPublic&&(this.tempArticle.isPublic=!1)},create_at(){this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},data(){return{tempArticle:{},create_at:""}},methods:{uploadFile(){const e=this.$refs.fileInput.files[0],t=new FormData;t.append("file-to-upload",e);const l="https://vue3-course-api.hexschool.io/api/chaichai_api/admin/upload";this.$http.post(l,t).then((e=>{console.log(e.data),e.data.success&&(this.tempArticle.imageUrl=e.data.imageUrl)}))}},mixins:[B.Z]},J=l(89);const Q=(0,J.Z)(G,[["render",L]]);var R=Q,X=l(5919),ee=l(8464),te={data(){return{articles:[],tempArticle:[],isNew:!1,pagination:{}}},components:{ArticleModal:R,DelModal:X.Z,Pagination:ee.Z},methods:{getArticles(e=1){const t=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/articles?page=${e}`;this.$http.get(t).then((e=>{this.articles=e.data.articles,console.log(this.articles),this.pagination=e.data.pagination}))},openArticleModal(e,t){this.isNew=e,this.isNew?this.tempArticle={create_at:(new Date).getTime()/1e3}:this.tempArticle={...t},this.$refs.articleModal.showModal()},updateArticle(e){if(console.log("tempArticle",e),this.isNew){const t="https://vue3-course-api.hexschool.io/api/chaichai_api/admin/article";this.$http.post(t,{data:e}).then((e=>{this.$httpMessageState(e,"新增文章"),this.getArticles(),this.$refs.articleModal.hideModal()}))}else{const t=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/article/${this.tempArticle.id}`;this.$http.put(t,{data:e}).then((e=>{console.log(e),this.$httpMessageState(e,"新增文章"),this.getArticles(),this.$refs.articleModal.hideModal()}))}},openDelArticleModal(e){this.tempArticle={...e};const t=this.$refs.delModal;t.showModal()},delArticle(){const e=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/article/${this.tempArticle.id}`;this.$http.delete(e).then((e=>{console.log(e,this.tempArticle),this.$httpMessageState(e,"刪除文章");const t=this.$refs.delModal;t.hideModal(),this.getArticles()}))}},created(){this.getArticles()}};const le=(0,J.Z)(te,[["render",A]]);var ae=le}}]);
//# sourceMappingURL=47.db1876bd.js.map