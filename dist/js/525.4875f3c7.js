"use strict";(self["webpackChunkvue_final"]=self["webpackChunkvue_final"]||[]).push([[525],{8464:function(e,t,a){a.d(t,{Z:function(){return v}});var r=a(3396),s=a(9242),i=a(7139);const l={"aria-label":"Page navigation example"},d={class:"pagination justify-content-center"},o={key:0,class:"page-item"},n=(0,r._)("span",{"aria-hidden":"true"},"«",-1),c=[n],p=["onClick"],u={key:1,class:"page-item"},m=(0,r._)("span",{"aria-hidden":"true"},"»",-1),h=[m];function g(e,t,a,n,m,g){return(0,r.wg)(),(0,r.iD)("nav",l,[(0,r._)("ul",d,[1!==a.pages.current_page?((0,r.wg)(),(0,r.iD)("li",o,[(0,r._)("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=(0,s.iM)((e=>g.updatePage(a.pages.current_page-1)),["prevent"])),"aria-label":"Previous"},c)])):(0,r.kq)("",!0),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.pages.total_pages,(e=>((0,r.wg)(),(0,r.iD)("li",{class:(0,i.C_)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,r._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((t=>g.updatePage(e)),["prevent"])},(0,i.zw)(e),9,p)],2)))),128)),a.pages.current_page!==a.pages.total_pages?((0,r.wg)(),(0,r.iD)("li",u,[(0,r._)("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=(0,s.iM)((e=>g.updatePage(a.pages.current_page+1)),["prevent"])),"aria-label":"Next"},h)])):(0,r.kq)("",!0)])])}var _={props:["pages"],methods:{updatePage(e){console.log(e),this.$emit("emit-pages",e)}}},b=a(89);const w=(0,b.Z)(_,[["render",g]]);var v=w},7157:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var r=a(3396),s=a(7139),i=a(9242);const l={class:"container"},d={class:"row mt-5"},o={class:"table mt-5 text-center table-radius"},n=(0,r._)("thead",{class:"table-theme"},[(0,r._)("tr",null,[(0,r._)("th",{width:"120"},"購買時間"),(0,r._)("th",{width:"120"},"Email"),(0,r._)("th",{width:"300"},"購買項目"),(0,r._)("th",{width:"120"},"應付金額"),(0,r._)("th",{width:"120"},"是否付款"),(0,r._)("th",{width:"120"},"編輯")])],-1),c={class:"text-right"},p={class:"text-right"},u={key:0,class:"is-enabled-border is-enabled"},m={key:1,class:"is-enabled-border not-enabled"},h=["onClick"],g=(0,r._)("i",{class:"bi bi-pencil-square"},null,-1),_=[g],b=["onClick"],w=(0,r._)("i",{class:"bi bi-trash3"},null,-1),v=[w];function f(e,t,a,g,w,f){const O=(0,r.up)("OrderModal"),k=(0,r.up)("DelModal"),y=(0,r.up)("Pagination");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",l,[(0,r._)("div",d,[(0,r._)("table",o,[n,(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.orders,(t=>((0,r.wg)(),(0,r.iD)("tr",{key:t.id},[(0,r._)("td",null,(0,s.zw)(e.$filters.date(t.create_at)),1),(0,r._)("td",null,(0,s.zw)(t.user.email),1),(0,r._)("td",c,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.products,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t},(0,s.zw)(e.product.title)+" 數量："+(0,s.zw)(e.qty)+" "+(0,s.zw)(e.product.unit),1)))),128))]),(0,r._)("td",p,(0,s.zw)(e.$filters.currency(t.total)),1),(0,r._)("td",null,[t.is_paid?((0,r.wg)(),(0,r.iD)("span",u,"已付款")):((0,r.wg)(),(0,r.iD)("span",m,"未付款"))]),(0,r._)("td",null,[(0,r._)("button",{class:"btn btn-primary",onClick:(0,i.iM)((e=>f.openModal(t)),["prevent"])},_,8,h),(0,r._)("button",{class:"btn btn-danger",onClick:(0,i.iM)((e=>f.openDelOrderModal(t)),["prevent"])},v,8,b)])])))),128))])])])]),(0,r.Wm)(O,{ref:"orderModal",order:w.tempOrder,onReviseItem:f.reviseItem},null,8,["order","onReviseItem"]),(0,r.Wm)(k,{item:w.tempOrder,ref:"delModal",onDelItem:f.delOrder},null,8,["item","onDelItem"]),(0,r.Wm)(y,{pages:e.pagination,onEmitPages:e.getOrders},null,8,["pages","onEmitPages"])],64)}var O=a(1020),k=a(1076),y=(0,O.Q_)("orderStore",{state:()=>({orders:[],pagination:{}}),getters:{productList:e=>e.products},actions:{getOrders(e=1){return new Promise((async(t,a)=>{const r=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/orders/?page=${e}`;try{const e=await k.Z.get(r);console.log(e),this.orders=e.data.orders,this.pagination=e.data.pagination,t()}catch(s){console.log(s),a()}}))}}});const M={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},D={class:"modal-dialog",role:"document"},$={class:"modal-content border-0"},z=(0,r._)("div",{class:"modal-header bg-modal-brown text-white"},[(0,r._)("h5",{class:"modal-title"},[(0,r._)("span",null,"檢視訂單")]),(0,r._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},C={class:"mb-3"},P={class:"mb-3"},Z={class:"mb-3"},I={class:"mb-3"},q={class:"mb-3"},H={class:"mb-3"},Y={class:"mb-3"},E={class:"form-check"},K=(0,r._)("label",{class:"form-check-label",for:"is_paid"}," 是否付款 ",-1),j={class:"modal-footer"},W=(0,r._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function L(e,t,a,l,d,o){return(0,r.wg)(),(0,r.iD)("div",M,[(0,r._)("div",D,[(0,r._)("div",$,[z,(0,r._)("div",x,[(0,r._)("div",C," 訂購人："+(0,s.zw)(d.user.name),1),(0,r._)("div",P," Email："+(0,s.zw)(d.user.email),1),(0,r._)("div",Z," 購買時間："+(0,s.zw)(e.$filters.date(d.tempOrder.create_at)),1),(0,r._)("div",I,[(0,r.Uk)(" 訂單列表："),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(d.tempOrder.products,((e,t)=>((0,r.wg)(),(0,r.iD)("div",{key:t},(0,s.zw)(e.product.title)+" 數量："+(0,s.zw)(e.qty)+" "+(0,s.zw)(e.product.unit),1)))),128))]),(0,r._)("div",q," 應付金額："+(0,s.zw)(e.$filters.currency(d.tempOrder.total)),1),(0,r._)("div",H," 留言："+(0,s.zw)(d.tempOrder.message),1),(0,r._)("div",Y,[(0,r._)("div",E,[(0,r.wy)((0,r._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>d.tempOrder.is_paid=e),true:1,false:0,id:"is_paid"},null,512),[[i.e8,d.tempOrder.is_paid]]),K])])]),(0,r._)("div",j,[W,(0,r._)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=t=>e.$emit("revise-item",d.tempOrder))},"確認 ")])])])],512)}var R=a(1339),S={props:{order:{type:Object,default(){return{}}}},data(){return{modal:{},tempOrder:{},user:""}},watch:{order(){this.tempOrder=this.order,this.user=this.tempOrder.user,console.log("tempOrder",this.tempOrder)}},mixins:[R.Z]},U=a(89);const N=(0,U.Z)(S,[["render",L]]);var Q=N,V=a(5919),A=a(8464),B={data(){return{tempOrder:{}}},components:{OrderModal:Q,DelModal:V.Z,Pagination:A.Z},inject:["emitter"],computed:{...(0,O.rn)(y,["orders","pagination"])},methods:{...(0,O.nv)(y,["getOrders"]),openModal(e){this.tempOrder={...e};const t=this.$refs.orderModal;t.showModal()},reviseItem(e){this.tempOrder=e;const t=this.$refs.orderModal,a=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/order/${this.tempOrder.id}`;this.$http.put(a,{data:this.tempOrder}).then((e=>{e.data.success&&(t.hideModal(),this.getOrders())}))},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/chaichai_api/admin/order/${this.tempOrder.id}`;this.$http.delete(e).then((e=>{if(e.data.success){console.log(e);const t=this.$refs.delModal;t.hideModal(),this.$httpMessageState(e,e.data.message),this.getOrders()}}))}},created(){this.getOrders()}};const F=(0,U.Z)(B,[["render",f]]);var G=F}}]);
//# sourceMappingURL=525.4875f3c7.js.map